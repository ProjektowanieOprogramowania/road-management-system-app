<ng-container *ngIf="tariff; else loading">
  <div class="flex-container test" [style]="{width: '800px', marginLeft: 'auto', marginRight: 'auto'}">
    <p class="header">Stwórz nowy taryfikator</p>
    <div [style]="{display: 'flex', flexDirection: 'column', gap: '20px'}">
      <input type="text" pInputText placeholder="Nazwa taryfikatora" [(ngModel)]="tariff.name">
      <p-checkbox label="Aktywny po stworzeniu" [(ngModel)]="tariff.active" [binary]="true"></p-checkbox>

      <div>
        <p class="header">Warianty cenowe</p>
        <div [style]="{display: 'flex', gap: '20px'}">
          <input type="text" pInputText [(ngModel)]="addPriceName" [class]="nameFieldValid ? '' : 'ng-invalid ng-dirty'"
                 placeholder="Nazwa">
          <p-inputNumber [(ngModel)]="addPriceValue" [class]="priceFieldValid ? '' : 'ng-invalid ng-dirty'"
                         placeholder="Cena" mode="currency" currency="PLN" locale="pl-PL"></p-inputNumber>
          <button pButton type="button" icon="pi pi-plus" class="ui-button-info" [label]="'Add'"
                  (click)="newRow()"></button>
        </div>
      </div>

      <p-table [value]="getArray(tariff.prices)" *ngIf="tariff.prices.size > 0; else noTariffs">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="name">
              Nazwa
              <p-sortIcon field="name"></p-sortIcon>
            </th>
            <th pSortableColumn="customer">
              Cena
            </th>
            <th style="width: 3rem"></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-price>
          <tr>
            <td>{{price.name}}</td>
            <td>{{price.value + " zł"}}</td>
            <td [style]="{display: 'flex'}">
              <button type="button" pButton class="p-button-text p-button-rounded p-button-danger" icon="pi pi-trash"
                      (click)="deletePrice(price.name)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <ng-template #noTariffs>
        <p-table [value]="[0]">
          <ng-template pTemplate="header">
            <tr>
              <th>
                Nazwa
              </th>
              <th>
                Cena
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body">
            <tr>
              <td colspan="2">Brak dodanych taryfikatorów</td>
            </tr>
          </ng-template>
        </p-table>
      </ng-template>
    </div>
    <button pButton type="button" icon="pi pi-plus" class="ui-button-success" [label]="'Create'"
            [style]="{marginTop: '20px', marginLeft: 'auto', marginRight: '0', display: 'flex', width: '10em'}"></button>
  </div>
</ng-container>
<ng-template #loading>
  <p-progressSpinner [style]="{width: '50px', height: '50px'}"></p-progressSpinner>
</ng-template>
